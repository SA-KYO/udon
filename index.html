<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>型番動的生成 テスト</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-md mx-auto bg-white p-6 rounded-lg shadow">
    <h1 class="text-xl font-bold mb-4 text-gray-700">修理依頼フォーム（型番テスト）</h1>

    <!-- 「機器の種類」セレクト -->
    <div class="mb-4">
      <label for="machineType" class="block text-sm font-medium text-gray-700">機器の種類 *</label>
      <select id="machineType" name="machineType" required
              class="mt-1 block w-full px-3 py-2 border border-gray-300 
                     bg-white rounded-md shadow-sm focus:outline-none focus:ring
                     focus:ring-indigo-200 focus:border-indigo-300">
        <option value="">選択してください</option>
        <option value="seimenki">製麺機</option>
        <option value="presski">プレス機</option>
        <option value="noodlekneader">ニーダー(ミキサー)</option>
        <option value="other_machine">その他</option>
      </select>
    </div>

    <!-- 「型番」セレクト（ここに JS で項目を挿入する） -->
    <div class="mb-4">
      <label for="modelNumber" class="block text-sm font-medium text-gray-700">型番</label>
      <select id="modelNumber" name="modelNumber"
              class="mt-1 block w-full px-3 py-2 border border-gray-300 
                     bg-white rounded-md shadow-sm focus:outline-none focus:ring
                     focus:ring-indigo-200 focus:border-indigo-300">
        <option value="">機種を選択してください</option>
      </select>
    </div>

    <!-- 故障内容（表示用途） -->
    <div class="mb-4">
      <label class="block text-sm font-medium text-gray-700">故障内容</label>
      <div id="troubleSymptoms"
           class="mt-2 p-3 border border-gray-200 rounded-md text-gray-700 text-sm">
        機器の種類を選択すると、ここにチェック項目が表示されます。
      </div>
    </div>
  </div>

  <!-- JavaScript: 絶対に</body> の直前に置いてください -->
  <script>
    // 1) 型番データ (機器の種類ごと)
    const modelData = {
      seimenki: [
        { value: 'm305p', text: 'M305-P' },
        { value: 'm808p', text: 'M808-P' },
        { value: 'sanuki_ichiban', text: 'さぬき一番' },
        { value: 'sanuki_m301p', text: 'さぬきM301P' },
        { value: 'sarashina', text: '更科' },
        { value: 'top_noodle_tp1', text: 'トップヌードルTP-1型' },
        { value: 'top_noodle_tp2', text: 'トップヌードルTP-2型' },
        { value: 'other_seimenki_model', text: 'その他製麺機型番' }
      ],
      presski: [
        { value: 'm1p', text: 'M-1P' },
        { value: 'm2p', text: 'M-2P' },
        { value: 'rp1p', text: 'RP-1P' },
        { value: 'rp3p', text: 'RP-3P' },
        { value: 'rp200p', text: 'RP-200P' },
        { value: 'rp300p', text: 'RP-300P' },
        { value: 'other_press_model', text: 'その他プレス機型番' }
      ],
      noodlekneader: [
        { value: 'sn6st', text: 'SN-6ST' },
        { value: 'sn6dx', text: 'SN-6DX' },
        { value: 'sn6p', text: 'SN-6P' },
        { value: 'sn12p', text: 'SN-12P' },
        { value: 'sn25p', text: 'SN-25P' },
        { value: 'other_kneader_model', text: 'その他ニーダー型番' }
      ],
      other_machine: [
        // 必要なら「その他」のチェック項目をここに入れます
      ]
    };

    // 2) 故障内容チェックボックスのデータ (機器の種類ごと)
    const troubleData = {
      seimenki: [
        { category: '電源・起動の問題', symptoms: [
            { id: 'seimenki_power_off', text: '電源が入らない（ランプも点灯しない）' },
            { id: 'seimenki_power_on_not_working', text: '電源ランプは点灯するが、動作しない' }
        ]},
        { category: '麺に関する問題', symptoms: [
            { id: 'seimenki_noodle_cut_fail', text: '麺が切れない、または切れ方がおかしい' },
            { id: 'seimenki_noodle_jam', text: '麺が詰まる、または途中で引っかかる' }
        ]},
        { category: '動作の異常', symptoms: [
            { id: 'seimenki_roll_not_rotating', text: 'ロール（ローラー）が回転しない' },
            { id: 'seimenki_noodle_not_feeding', text: '麺がうまく入っていかない' },
            { id: 'seimenki_belt_issue', text: 'ベルトコンベアが動かない、または片寄る' }
        ]},
        { category: '音に関する問題', symptoms: [
            { id: 'seimenki_noise', text: '異音がする（動画での報告を推奨します）' }
        ]},
        { category: 'その他', symptoms: [
            { id: 'seimenki_other_symptom', text: '上記以外の症状がある' }
        ]}
      ],
      presski: [
        { category: '電源・起動の問題', symptoms: [
            { id: 'presski_power_off', text: '電源が入らない（ランプも点灯しない）' },
            { id: 'presski_power_on_not_working', text: '電源ランプは点灯するが、動作しない' }
        ]},
        { category: '動作の異常', symptoms: [
            { id: 'presski_roll_stop', text: 'ロール（ローラー）が回転しない、または途中で止まる' }
        ]},
        { category: '音に関する問題', symptoms: [
            { id: 'presski_noise', text: '異音がする（動画での報告を推奨します）' }
        ]},
        { category: 'その他', symptoms: [
            { id: 'presski_other_symptom', text: '上記以外の症状がある' }
        ]}
      ],
      noodlekneader: [
        { category: '電源・起動の問題', symptoms: [
            { id: 'noodlekneader_power_off', text: '電源が入らない（ランプも点灯しない）' },
            { id: 'noodlekneader_power_on_not_working', text: '電源ランプは点灯するが、動作しない' }
        ]},
        { category: '動作の異常', symptoms: [
            { id: 'noodlekneader_blade_stop', text: '練り羽根が回転しない、または途中で止まる' },
            { id: 'noodlekneader_blade_heavy', text: '練り羽根の動きが重い、または遅い' }
        ]},
        { category: '音に関する問題', symptoms: [
            { id: 'noodlekneader_noise_rattle', text: '異音がする（ガタガタ、ゴトゴトなど）' },
            { id: 'noodlekneader_motor_noise', text: 'モーター音が普段より大きい、またはおかしい' }
        ]},
        { category: 'その他', symptoms: [
            { id: 'noodlekneader_other_symptom', text: '上記以外の症状がある' }
        ]}
      ],
      other_machine: [
        { category: '症状について', symptoms: [
            { id: 'other_machine_symptom_manual', text: '詳細な症状を下の「詳細な症状」欄にご記入ください。' }
        ]}
      ]
    };

    //--------------------------------------------------
    // 3) DOM 要素を取得
    //--------------------------------------------------
    const machineTypeSelect  = document.getElementById('machineType');
    const modelNumberSelect  = document.getElementById('modelNumber');
    const troubleDiv         = document.getElementById('troubleSymptoms');

    //--------------------------------------------------
    // 4) 「機器の種類」が変わったら 型番 と 故障内容チェックを再生成
    //--------------------------------------------------
    machineTypeSelect.addEventListener('change', function() {
      const selectedKey = this.value; // 例: "seimenki" など

      // ———─ 型番セレクトを一旦クリア ─———
      modelNumberSelect.innerHTML = '<option value="">機種を選択してください</option>';
      if (selectedKey && modelData[selectedKey]) {
        modelData[selectedKey].forEach(item => {
          const opt = document.createElement('option');
          opt.value = item.value;    // 例: "m305p"
          opt.textContent = item.text; // 例: "M305-P"
          opt.className = 'text-gray-900';
          modelNumberSelect.appendChild(opt);
        });
      }
      // 「その他」が選択された場合には、必要なら手入力案内などを追加してもよい

      // ———─ 故障内容チェックボックスを一旦クリア ─———
      troubleDiv.innerHTML = "";
      if (selectedKey && troubleData[selectedKey]) {
        troubleData[selectedKey].forEach(categoryItem => {
          // カテゴリタイトルを追加
          const h3 = document.createElement('h3');
          h3.className = 'font-semibold text-gray-700 mt-3 mb-1';
          h3.textContent = categoryItem.category;
          troubleDiv.appendChild(h3);

          // 各チェックボックスを追加
          categoryItem.symptoms.forEach(symptom => {
            const label = document.createElement('label');
            label.className = 'checkbox-label text-sm text-gray-700';
            const chk = document.createElement('input');
            chk.type = 'checkbox';
            chk.id = symptom.id;
            chk.name = 'symptoms';
            chk.value = symptom.id;
            chk.className = 'mr-2';
            label.appendChild(chk);
            label.appendChild(document.createTextNode(symptom.text));
            troubleDiv.appendChild(label);
            troubleDiv.appendChild(document.createElement('br'));
          });
        });
      } else {
        // 未選択またはデータなしの場合の案内文
        const p1 = document.createElement('p');
        p1.className = 'text-sm text-gray-500';
        p1.textContent = '機器の種類を選択すると、故障内容のチェック項目が表示されます。';
        troubleDiv.appendChild(p1);
      }
    });

    //--------------------------------------------------
    // 5) 最初にページを開いたときにも問題ないように、
    //    必要なら document.addEventListener("DOMContentLoaded", …) でも囲えます。
    //--------------------------------------------------

    // （もし script を <head> 内などに置いてしまった場合は、以下のように
    //   window.onload や DOMContentLoaded でラップすると必ず動きます：）
    //
    // window.addEventListener("DOMContentLoaded", function() {
    //   // machineTypeSelect.addEventListener … の処理をここに移動
    // });

  </script>
</body>
</html>
